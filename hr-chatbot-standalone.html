<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAX2 HR Assistant - Walmart</title>
    <meta name="description" content="24/7 HR support for Walmart LAX2 associates">
    <style>
        /* Reset and Base Styles */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --walmart-blue: #0071ce;
            --walmart-blue-dark: #004f9f;
            --walmart-yellow: #ffc220;
            --text-primary: #2d2d2d;
            --text-secondary: #666666;
            --bg-light: #f5f7fa;
            --white: #ffffff;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            --focus-ring: 0 0 0 3px rgba(0, 113, 206, 0.4);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--walmart-blue) 0%, var(--walmart-blue-dark) 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
            line-height: 1.5;
        }

        /* Skip Link for Accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--walmart-blue);
            color: var(--white);
            padding: 8px 16px;
            text-decoration: none;
            z-index: 1000;
            border-radius: 0 0 4px 0;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Main Container */
        .chat-container {
            background: var(--white);
            border-radius: 20px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 650px;
            height: 90vh;
            max-height: 750px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--walmart-blue) 0%, var(--walmart-blue-dark) 100%);
            color: var(--white);
            padding: 20px 24px;
            text-align: center;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .header-icon {
            font-size: 32px;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .header p {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            margin-top: 8px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Messages Area */
        .messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: var(--bg-light);
            scroll-behavior: smooth;
        }

        .message {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(12px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .message.user .avatar {
            background: var(--walmart-blue-dark);
        }

        .message.assistant .avatar {
            background: var(--walmart-yellow);
        }

        .message-content {
            max-width: 75%;
        }

        .message-bubble {
            padding: 14px 18px;
            border-radius: 18px;
            word-wrap: break-word;
            font-size: 0.95rem;
        }

        .message.user .message-bubble {
            background: var(--walmart-blue);
            color: var(--white);
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-bubble {
            background: var(--white);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .confidence-badge {
            display: inline-block;
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 6px;
            padding: 2px 8px;
            background: var(--bg-light);
            border-radius: 10px;
        }

        /* Welcome Screen */
        .welcome {
            text-align: center;
            padding: 40px 24px;
        }

        .welcome-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .welcome h2 {
            color: var(--text-primary);
            font-size: 1.5rem;
            margin-bottom: 12px;
        }

        .welcome p {
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .topic-chips {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
        }

        .topic-chip {
            background: var(--white);
            border: 2px solid var(--walmart-blue);
            color: var(--walmart-blue);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .topic-chip:hover, .topic-chip:focus {
            background: var(--walmart-blue);
            color: var(--white);
            outline: none;
            box-shadow: var(--focus-ring);
        }

        /* Fallback Banner */
        .fallback-banner {
            background: #fef3cd;
            border-left: 4px solid var(--walmart-yellow);
            padding: 14px 16px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }

        .fallback-banner strong {
            display: block;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .fallback-banner a {
            color: var(--walmart-blue);
            font-weight: 600;
        }

        .fallback-banner a:focus {
            outline: 2px solid var(--walmart-blue);
            outline-offset: 2px;
        }

        /* Input Area */
        .input-area {
            padding: 16px 20px;
            background: var(--white);
            border-top: 1px solid #e5e7eb;
        }

        .input-container {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #user-input {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 28px;
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: var(--bg-light);
        }

        #user-input:focus {
            outline: none;
            border-color: var(--walmart-blue);
            box-shadow: var(--focus-ring);
            background: var(--white);
        }

        #user-input::placeholder {
            color: #9ca3af;
        }

        #send-btn {
            background: var(--walmart-blue);
            color: var(--white);
            border: none;
            width: 52px;
            height: 52px;
            border-radius: 50%;
            font-size: 1.25rem;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #send-btn:hover:not(:disabled) {
            background: var(--walmart-blue-dark);
            transform: scale(1.05);
        }

        #send-btn:focus {
            outline: none;
            box-shadow: var(--focus-ring);
        }

        #send-btn:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }

        /* Loading Animation */
        .loading-dots {
            display: flex;
            gap: 4px;
            padding: 8px 0;
        }

        .loading-dot {
            width: 10px;
            height: 10px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: bounce 1.4s ease-in-out infinite;
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        .loading-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 480px) {
            .chat-container {
                height: 100vh;
                max-height: none;
                border-radius: 0;
            }

            .header h1 {
                font-size: 1.25rem;
            }

            .message-content {
                max-width: 85%;
            }
        }

        /* Screen Reader Only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <a href="#user-input" class="skip-link">Skip to chat input</a>

    <main class="chat-container" role="main" aria-label="HR Chatbot">
        <header class="header">
            <div class="header-content">
                <span class="header-icon" aria-hidden="true">üíº</span>
                <div>
                    <h1>LAX2 HR Assistant</h1>
                    <p>Your 24/7 HR support companion</p>
                </div>
            </div>
            <div class="status-badge">
                <span class="status-dot" aria-hidden="true"></span>
                <span>Online - FAQ Mode</span>
            </div>
        </header>

        <div class="messages" id="messages" role="log" aria-live="polite" aria-label="Chat messages">
            <div class="welcome" id="welcome">
                <div class="welcome-icon" aria-hidden="true">üëã</div>
                <h2>Welcome to HR Support!</h2>
                <p>I can help answer your HR questions about:</p>
                <div class="topic-chips" role="group" aria-label="Quick topic buttons">
                    <button class="topic-chip" onclick="askQuestion('What happens if I leave before my 5th
hour?')">Attendance Points</button>
                    <button class="topic-chip" onclick="askQuestion('Can I use PTO for an emergency?')">PTO vs
PPTO</button>
                    <button class="topic-chip" onclick="askQuestion('How do I change my shift?')">Shift
Transfer</button>
                    <button class="topic-chip" onclick="askQuestion('Do you accept doctor notes?')">Doctor
Notes</button>
                </div>
            </div>
        </div>

        <div class="input-area">
            <label for="user-input" class="sr-only">Type your HR question</label>
            <div class="input-container">
                <div class="input-wrapper">
                    <input
                        type="text"
                        id="user-input"
                        placeholder="Ask about attendance, PTO, benefits..."
                        autocomplete="off"
                        aria-describedby="input-hint"
                    >
                    <span id="input-hint" class="sr-only">Press Enter to send your question</span>
                </div>
                <button id="send-btn" aria-label="Send message">
                    <span aria-hidden="true">‚û§</span>
                </button>
            </div>
        </div>
    </main>

    <script>
        // ============================================
        // FAQ DATABASE - All your HR answers!
        // ============================================
        const FAQ_DATABASE = [
            {
                keywords: ['5th hour', 'leave early', 'full point', 'incomplete shift', 'before 5th', 'leave before'],
                question: 'What happens if I leave before my 5th hour?',
                answer: 'If you leave before hitting your 5th hour, it will be a full point. Leaving prior to your 5th
hour is considered an incomplete shift, so you will receive a full point. If you leave at your 5th hour or later (but
before the end of your shift), it will only be 0.5 points.',
                confidence: 0.95
            },
            {
                keywords: ['6th hour', 'lunch', 'skip lunch', 'lunch exempt', 'take lunch', 'meal break'],
                question: 'Do I need to take lunch if I leave at my 6th hour?',
                answer: 'If you leave at your 6th hour or prior to your 6th hour, you do not have to take a lunch.',
                confidence: 0.95
            },
            {
                keywords: ['pto emergency', 'pto vs ppto', 'use pto', 'ppto difference', 'emergency pto', 'pto for
emergency'],
                question: 'Can I use PTO for an emergency?',
                answer: 'No, PTO requires associates to submit the request for approval as far in advance as possible.
To cover emergencies, you must use PPTO (Protected PTO). PPTO is specifically designed for unexpected situations like
illness or emergencies.',
                confidence: 0.95
            },
            {
                keywords: ['no ppto', 'out of ppto', 'dont have ppto', "don't have ppto", 'ppto gone', 'no protected
pto'],
                question: 'What if I don\'t have any PPTO?',
                answer: 'If you don\'t have PPTO available, you risk obtaining an attendance point for incomplete shift,
early out, or absence. Consider building up your PPTO balance for future emergencies.',
                confidence: 0.95
            },
            {
                keywords: ['doctor note', 'accommodation', 'medical', 'restriction', 'doctor documentation', 'work
restriction', 'medical accommodation'],
                question: 'Can I get accommodations with a doctor\'s note?',
                answer: 'We cannot accommodate based solely on a doctor\'s note brought in-house. You must go through
the official accommodation process and submit your doctor\'s documentation to the Accommodations team for approval. In
the meantime, you may need to open a Leave of Absence (LOA) to cover any absences while waiting for accommodation
confirmation.',
                confidence: 0.95
            },
            {
                keywords: ['leave and come back', 'leave and return', 'go home come back', 'leave return same shift'],
                question: 'Can I leave and come back during my shift?',
                answer: 'You must notify your manager prior to leaving the building. However, you are still responsible
for covering the time you were gone with PPTO. Even if you return to finish your shift, the time away needs to be
covered.',
                confidence: 0.95
            },
            {
                keywords: ['change shift', 'transfer shift', 'switch shift', 'different shift', 'move shift', 'shift
transfer'],
                question: 'How do I change or transfer to a different shift?',
                answer: 'To transfer shifts, you must first check if there are open roles available and apply through
the competitive process. You\'ll need to meet time-in-position requirements, have acceptable attendance points, and no
active corrective actions (orange/DA). If no roles are available, you can escalate your request through the Open-Door
Process by speaking with an AGM and HRM.',
                confidence: 0.95
            },
            {
                keywords: ['doctor note excuse', 'doctors note absence', 'excuse absence', 'note from doctor', 'accept
doctor note'],
                question: 'Will a doctor\'s note excuse my absence?',
                answer: 'Unfortunately, we do not accept doctor\'s notes in-house to excuse absences. Your options are:
1) Use PPTO to cover the time, 2) Accept the attendance point, or 3) Open a Leave of Absence (LOA) with Sedgwick if you
have a qualifying medical situation.',
                confidence: 0.95
            },
            {
                keywords: ['call off ppto', 'call in ppto', 'report absence ppto', 'still call off', 'report absence'],
                question: 'Do I still need to call off if I\'m using PPTO?',
                answer: 'Yes! Even when using PPTO, you must still report your absence through the Walmart associate
hotline or the Me@Walmart app. If you don\'t call off, you may still receive an attendance point even if you have PPTO
to cover the time. Always report your absence AND apply your PPTO.',
                confidence: 0.95
            },
            {
                keywords: ['pto balance', 'check pto', 'how much pto', 'pto hours', 'ppto balance'],
                question: 'How do I check my PTO balance?',
                answer: 'You can check your PTO and PPTO balance through the Me@Walmart app or on the WIRE/OneWalmart
portal. Go to your profile, then look for Time Off or PTO Balance. Your available hours will be displayed there.',
                confidence: 0.90
            },
            {
                keywords: ['attendance point', 'points system', 'how many points', 'point expire', 'attendance policy'],
                question: 'How does the attendance point system work?',
                answer: 'Walmart uses an attendance point system. Points are given for absences, tardiness, and leaving
early. A full absence is typically 1 point, while partial absences (like leaving early after 5th hour) are 0.5 points.
Points typically expire after 6 months. Accumulating too many points may result in corrective action up to
termination.',
                confidence: 0.90
            },
            {
                keywords: ['loa', 'leave of absence', 'sedgwick', 'fmla', 'medical leave'],
                question: 'How do I request a Leave of Absence?',
                answer: 'To request a Leave of Absence (LOA), you need to contact Sedgwick, Walmart\'s leave
administrator. You can reach them at 1-800-492-5678 or through mySedgwick.com. They handle FMLA, medical leave, personal
leave, and other types of LOA. Start this process as soon as you know you\'ll need extended time off.',
                confidence: 0.90
            },
            {
                keywords: ['pay', 'paycheck', 'payday', 'when paid', 'pay stub', 'direct deposit'],
                question: 'When do I get paid?',
                answer: 'Walmart associates are typically paid bi-weekly (every two weeks). Pay is deposited on
Thursday, or you can access your pay early through the Even app. You can view your pay stubs through OneWalmart or the
Me@Walmart app.',
                confidence: 0.85
            },
            {
                keywords: ['benefits', 'health insurance', 'medical insurance', 'dental', 'vision', 'insurance'],
                question: 'What benefits does Walmart offer?',
                answer: 'Walmart offers various benefits including health insurance (medical, dental, vision), 401(k)
with company match, associate discount, life insurance, and more. Eligibility depends on your employment status and
hours worked. Full-time associates typically have access to more benefits. Visit OneWalmart or speak with HR for
detailed information.',
                confidence: 0.85
            },
            {
                keywords: ['discount', 'associate discount', 'employee discount', '10 percent', '10%'],
                question: 'How does the associate discount work?',
                answer: 'The Walmart associate discount is typically 10% off most regular-priced merchandise. You\'ll
receive a discount card after your initial waiting period (usually 90 days). The discount applies to purchases made at
Walmart stores. Some exclusions apply, and the discount typically increases around the holidays.',
                confidence: 0.85
            },
            {
                keywords: ['schedule', 'view schedule', 'check schedule', 'my schedule', 'work schedule'],
                question: 'How do I check my work schedule?',
                answer: 'You can view your schedule through the Me@Walmart app or on the WIRE at work. The app allows
you to see your upcoming shifts, request time off, and swap shifts with coworkers. Make sure to check your schedule
regularly for any updates.',
                confidence: 0.90
            },
            {
                keywords: ['swap shift', 'trade shift', 'give away shift', 'shift swap'],
                question: 'Can I swap shifts with a coworker?',
                answer: 'Yes, you can request shift swaps through the Me@Walmart app. Both you and your coworker must
agree to the swap, and it may require manager approval. Make sure both parties are trained for the positions being
swapped.',
                confidence: 0.90
            },
            {
                keywords: ['hr contact', 'talk to hr', 'hr phone', 'hr email', 'people lead', 'human resources'],
                question: 'How do I contact HR?',
                answer: 'You can speak with your People Lead or HR representative on-site during business hours. For
corporate HR matters, you can call the Associate Information Line at 1-800-421-1362. For urgent concerns, use the Open
Door policy to speak with any member of management.',
                confidence: 0.90
            },
            {
                keywords: ['covid', 'sick', 'positive test', 'quarantine', 'coronavirus'],
                question: 'What do I do if I\'m sick or test positive for COVID?',
                answer: 'If you\'re sick or test positive for COVID, do not come to work. Report your absence through
the normal call-off procedures. Depending on current policies, you may be eligible for COVID-related leave. Contact
Sedgwick at 1-800-492-5678 for leave options and your People Lead for current guidelines, as policies may change.',
                confidence: 0.85
            },
            {
                keywords: ['overtime', 'ot', 'extra hours', 'work overtime'],
                question: 'How does overtime work?',
                answer: 'Overtime is typically paid at 1.5x your regular rate for hours worked over 40 in a workweek.
However, overtime must usually be approved by your manager in advance. Unauthorized overtime may result in coaching.
Check with your manager about overtime availability and approval process.',
                confidence: 0.85
            },
            {
                keywords: ['seasonal', 'convert', 'full-time', 'fulltime', 'permanent', 'seasonal to full', 'convert
seasonal', '90 day', '120 day', '150 day'],
                question: 'How can a seasonal get converted to full-time?',
                answer: 'You can apply to open positions on the Career Preference on One.Walmart.com. If you are looking
to convert from seasonal full-time, in your current position, you must meet the eligibility requirements. Attendance
should be no more than 2.5 points and no colored disciplinary actions. Walmart will review at your 90, 120, 150 day and
evaluate if they have permanent positions available. Partner with your manager or Human Resources if you have further
questions.',
                confidence: 0.95
            },
            {
                keywords: ['seasonal apply', 'seasonal position', 'seasonal open', 'can seasonal apply'],
                question: 'Can a seasonal associate apply to open positions?',
                answer: 'Yes, you can through Career Preference on One.Walmart.com.',
                confidence: 0.95
            },
            {
                keywords: ['apply requisition', 'open requisition', 'apply position', 'how to apply', 'career
preference', 'apply job'],
                question: 'How do I apply to open requisitions?',
                answer: 'Through Career Preference on One.Walmart.com.',
                confidence: 0.95
            },
            {
                keywords: ['points fall off', 'points expire', 'attendance expire', 'how long points', 'points removed',
'points drop'],
                question: 'How long does it take for points to fall off?',
                answer: 'Attendance points are removed at 6 months.',
                confidence: 0.95
            },
            {
                keywords: ['da fall off', 'da expire', 'disciplinary action expire', 'how long da', 'da removed', 'da
drop', 'disciplinary fall off'],
                question: 'How long does it take DAs to fall off?',
                answer: 'DAs (Disciplinary Actions) take 24 months to fall off.',
                confidence: 0.95
            }
        ];

        // SharePoint list URL for fallback
        const SHAREPOINT_URL =
'https://teams.wal-mart.com/sites/LAX2HR560/_layouts/15/listforms.aspx?cid=NjBiN2EyYmQtZjNlZC00MTk1LTkyMDUtMTZiMzU0MWY2O
WM4&nav=NTIwMTZjNDEtNDhjNi00MTFhLThjN2MtNTY0YjRjM2Q0NTE5';

        // ============================================
        // CHATBOT LOGIC
        // ============================================
        const messagesDiv = document.getElementById('messages');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const welcomeDiv = document.getElementById('welcome');
        let isWelcomeVisible = true;

        // Handle Enter key
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !sendBtn.disabled) {
                sendMessage();
            }
        });

        // Send button click
        sendBtn.addEventListener('click', sendMessage);

        // Quick question buttons
        function askQuestion(question) {
            userInput.value = question;
            sendMessage();
        }

        function hideWelcome() {
            if (isWelcomeVisible && welcomeDiv) {
                welcomeDiv.style.display = 'none';
                isWelcomeVisible = false;
            }
        }

        function addMessage(text, isUser, confidence = null, showFallback = false) {
            hideWelcome();

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'assistant'}`;

            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            avatar.setAttribute('aria-hidden', 'true');
            avatar.textContent = isUser ? 'üë§' : 'ü§ñ';

            const content = document.createElement('div');
            content.className = 'message-content';

            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';
            bubble.textContent = text;

            content.appendChild(bubble);

            if (confidence !== null && !isUser) {
                const badge = document.createElement('div');
                badge.className = 'confidence-badge';
                badge.textContent = `Confidence: ${Math.round(confidence * 100)}%`;
                content.appendChild(badge);
            }

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            messagesDiv.appendChild(messageDiv);

            // Add fallback banner if needed
            if (showFallback && !isUser) {
                const fallback = document.createElement('div');
                fallback.className = 'fallback-banner';
                fallback.innerHTML = `
                    <strong>üìù Need more help?</strong>
                    I couldn't find an exact answer for your question. Please submit your request to the LAX2 HR team:
                    <a href="${SHAREPOINT_URL}" target="_blank" rel="noopener noreferrer">Click here to submit an HR
request</a>
                `;
                messagesDiv.appendChild(fallback);
            }

            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function addLoading() {
            hideWelcome();

            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message assistant';
            loadingDiv.id = 'loading-message';

            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            avatar.setAttribute('aria-hidden', 'true');
            avatar.textContent = 'ü§ñ';

            const content = document.createElement('div');
            content.className = 'message-content';

            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';
            bubble.innerHTML = '<div class="loading-dots"><div class="loading-dot"></div><div
class="loading-dot"></div><div class="loading-dot"></div></div>';
            bubble.setAttribute('aria-label', 'Thinking...');

            content.appendChild(bubble);
            loadingDiv.appendChild(avatar);
            loadingDiv.appendChild(content);
            messagesDiv.appendChild(loadingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function removeLoading() {
            const loading = document.getElementById('loading-message');
            if (loading) loading.remove();
        }

        // Fuzzy matching - find best FAQ match
        function findBestMatch(userMessage) {
            const normalizedInput = userMessage.toLowerCase().trim();
            let bestMatch = null;
            let bestScore = 0;

            for (const faq of FAQ_DATABASE) {
                let score = 0;

                // Check each keyword
                for (const keyword of faq.keywords) {
                    if (normalizedInput.includes(keyword.toLowerCase())) {
                        // Longer keywords get more weight
                        score += keyword.length;
                    }
                }

                // Bonus for multiple keyword matches
                const matchedKeywords = faq.keywords.filter(kw =>
                    normalizedInput.includes(kw.toLowerCase())
                );
                if (matchedKeywords.length > 1) {
                    score *= (1 + matchedKeywords.length * 0.2);
                }

                if (score > bestScore) {
                    bestScore = score;
                    bestMatch = faq;
                }
            }

            // Return match if score is decent
            if (bestScore >= 3) {
                return {
                    answer: bestMatch.answer,
                    confidence: Math.min(0.95, 0.6 + (bestScore * 0.05)),
                    showFallback: false
                };
            }

            // No good match found
            return {
                answer: "I'm not sure about that specific question. I'm currently running in FAQ-only mode, so I can
only answer questions from my knowledge base. Please try rephrasing your question, or submit your request directly to
the HR team for a personalized response.",
                confidence: 0.3,
                showFallback: true
            };
        }

        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            // Disable input
            userInput.disabled = true;
            sendBtn.disabled = true;

            // Add user message
            addMessage(message, true);
            userInput.value = '';

            // Show loading
            addLoading();

            // Simulate small delay for natural feel
            await new Promise(resolve => setTimeout(resolve, 500 + Math.random() * 500));

            // Find answer
            const result = findBestMatch(message);

            // Remove loading
            removeLoading();

            // Add response
            addMessage(result.answer, false, result.confidence, result.showFallback);

            // Re-enable input
            userInput.disabled = false;
            sendBtn.disabled = false;
            userInput.focus();
        }

        // Focus input on load
        window.addEventListener('load', () => {
            userInput.focus();
        });
    </script>
</body>
</html>
